an enterprise multi-agent system built on Microsoft Azure, showing the current architecture and available
  ecosystem alternatives for agent-to-agent communication. The diagram should follow the visual style of NeurIPS 2025 methodology diagrams: soft tech and
  scientific pastel color palette, rounded containers, clean directional arrows, and clear typography. The diagram should be landscape-oriented and structured in
  clearly separated zones flowing left to right.
  ZONE 1: USER INTERFACE (left side)
  A corporate user interacts through Microsoft Teams. Teams provides Single Sign-On (SSO) via Microsoft Entra ID, so the user is already authenticated with their
  organizational identity. Show the user with a Teams icon and example questions: "What is the travel policy?" and "Search my files for cv-template".
  ZONE 2: AGENT A -- COPILOT STUDIO (second column)
  Agent A is a Copilot Studio agent running inside Microsoft Teams. It serves as the user-facing orchestrator. Copilot Studio is a low-code platform for building
  conversational AI agents.
  Agent A has its own Entra ID App Registration acting as the OAuth Client. When the user asks a question, Agent A obtains an OAuth token scoped to Agent B's
  "access_as_user" permission, then calls Agent B's HTTP API using Invoker connection mode (each user's own token is forwarded, not a shared admin token).
  ZONE 3: COMMUNICATION LAYER (between Agent A and Agent B)
  Show this as a "protocol options panel" between Agent A and Agent B, with four protocol boxes stacked vertically.
  REST API via Custom Connector
   - Copilot Studio Custom Connector with OpenAPI spec
   - POST /policy/ask/obo with Bearer token
   - Simple request-response pattern
   - OAuth
    2.0 security scheme
   - Badge at top-right: "ACTIVE" with solid border and filled background
  A2A Protocol (Linux Foundation open standard)
   - Agent discovery card at /.well-known/agent.json
   - JSON-RPC
    2.0 dispatch (method: message/send)
   - Task lifecycle: submitted, working, completed, failed
   - Standardized cross-platform agent interoperability
   - Badge at top-right: "IMPLEMENTED" with dashed border and lighter fill
  Model Context Protocol (MCP, open standard)
   - Copilot Studio native support via Streamable HTTP transport
   - Foundry IQ knowledge bases expose MCP endpoints natively
   - Dynamic tool discovery, tool-level integration
   - Badge at top-right: "AVAILABLE" with dashed border and lighter fill
  Foundry Connected Agents (SDK-native)
   - Azure AI Foundry ConnectedAgentTool
   - Sub-agents within the same Foundry project
   - No custom HTTP connector needed
   - Badge at top-right: "AVAILABLE" with dashed border and lighter fill
  ZONE 4: AGENT B -- AZURE CONTAINER APP (third column)
  Agent B is a FastAPI application running on Azure Container Apps (Python 3.12 Docker image). It is registered as an agent in Azure AI Foundry and has its own
  Entra ID App Registration acting as the OAuth Resource Server.
  Agent B endpoints:
   - POST /policy/ask/obo -- Main endpoint (policy + user files)
   - POST / -- A2A JSON-RPC
    2.0 endpoint
   - GET /.well-known/agent.json -- A2A agent discovery card
   - GET /openapi-obo.json -- OpenAPI spec for Copilot Studio
  Processing logic (show as 3 numbered steps inside the box):
   1. ALWAYS query Foundry IQ (AI Search) for policy answers
   2. If Bearer token present, perform OBO token exchange
   3. Return combined results with provenance labels
  ZONE 5: OBO AUTHENTICATION FLOW (callout panel with coral/red dashed border)
  Show this as a distinct callout panel with a coral/red dashed border, positioned between Agent B and the Microsoft Graph data source. Label it "OAuth 2.0
  On-Behalf-Of (OBO) Flow -- RFC 7523".
  Four numbered steps with arrows connecting them:
  Step 1: Extract Bearer token from Authorization header of incoming request
  Step 2: POST to Microsoft Entra ID token endpoint with JWT Bearer grant type (grant_type = urn:ietf:params:oauth:grant-type:jwt-bearer), Agent B credentials,
  user assertion token, and requested Graph scopes (Files.Read, Sites.Read.All)
  Step 3: Entra ID validates trust chain between Agent A (OAuth Client) and Agent B (OAuth Resource Server), returns Microsoft Graph token scoped to
  authenticated user
  Step 4: Agent B holds delegated Graph token -- can access only files the authenticated user is authorized to see (principle of least privilege)
  ZONE 6: DATA SOURCES (right side, two parallel branches)
  Branch 1 (top): Foundry IQ -- Azure AI Search -- Company Knowledge
   - Azure AI Search index containing chunked company policy documents
   - Semantic search with automatic fallback to full-text search
   - Uses managed identity for authentication -- no user token needed
   - Provenance label: "foundry_iq"
  Show a compact sub-flow pipeline inside this box: Policy PDF --> Document Chunking --> Embeddings --> Azure AI Search Index
  At the bottom-right of this box, add a small label: "MCP Endpoint (available)" to indicate that this knowledge base also exposes an MCP endpoint for native
  agent tool invocation.
  Branch 2 (bottom): Microsoft Graph (OBO) -- User's Personal Files
   - Label: "Accessed ONLY when OBO token exchange succeeds"
   - Two search strategies running in parallel:Strategy A -- OneDrive Direct Search:
   GET /me/drive/root/search -- instant results, file name matching, no indexing delayStrategy B -- Microsoft Search API:
   POST /search/query with entityTypes driveItem -- content-indexed, searches inside files, may lag for new uploadsShow Strategy A and Strategy B as two parallel
   boxes feeding into a "Deduplication" box that merges results by file name.
   - Provenance label: "user_m365_files"
   - Returns: file name, web URL, content snippet
  ARROWS -- CRITICAL (must all be drawn as thick visible lines with arrowheads and labels)
  Forward flow (left to right, solid arrows):
   - Arrow 1 (BLUE): User to Agent A, label "Question"
   - Arrow 2 (BLUE): User to Entra ID SSO icon, label "SSO Authentication"
   - Arrow 3 (RED): Entra ID to Agent A, label "OAuth Token (access_as_user scope)"
   - Arrow 4 (GREEN): Agent A to Communication Layer, label "REST API Call"
   - Arrow 5 (PURPLE): Communication Layer to Agent B, label "Request with Bearer Token"
   - Arrow 6 (TEAL): Agent B to Foundry IQ box, label "Query (Managed Identity)"
   - Arrow 7 (RED): OBO step 4 to Microsoft Graph box, label "Delegated Graph Token"
  Return flow (right to left, solid arrows, placed at the BOTTOM of the zones so forward and return paths are visually separated):
   - Arrow 8 (ORANGE): Agent B LEFT through Communication Layer to Agent A, label "Combined Response (policy + user files with provenance)"
   - Arrow 9 (BLUE): Agent A LEFT to User, label "Answer in Teams"
  Alternative protocol paths (dashed arrows):
   - Thin dashed ORANGE line from Foundry IQ box to MCP protocol box in Zone 3, label "MCP Endpoint (available)" in small gray text
  IMPORTANT: Do NOT place any "Combined Answer" label pointing downward from Agent A toward Entra ID. The return flow goes LEFT from Agent A to the User, never
  downward.
  INFRASTRUCTURE LAYER (subtle background strip at bottom)
  Show as a subtle gray background strip spanning the full width with small icons:
   - Microsoft Entra ID -- Identity provider and OBO token exchange
   - Azure Container Apps -- Hosts and scales Agent B
   - Azure AI Foundry -- Agent configuration and model deployments
   - Azure AI Search -- Indexes and serves policy document chunks
  VISUAL STYLE
   - Landscape orientation, clearly separated vertical zones flowing left to right
   - Color coding with distinct soft pastel tones:
    - Blue/indigo: User and Teams interface
    - Green/emerald: Agent A (Copilot Studio)
    - Purple/violet: Communication Layer and protocol options panel
    - Orange/amber: Agent B (Azure Container App)
    - Red/coral: Entra ID and OBO authentication flow
    - Teal/cyan: Foundry IQ and Azure AI Search
    - Pink/rose: Microsoft Graph, OneDrive, SharePoint
    - Gray/slate: Infrastructure layer (background)
   - Protocol options panel: solid border for REST API (ACTIVE), dashed borders for alternatives
   - Rounded rectangles for all components
   - Solid arrows for active data paths, dashed arrows for alternative protocol paths
   - Clear parallel branching where Agent B queries both AI Search and Microsoft Graph simultaneously
   - Clean white or very light gray background
   - All text legible, sans-serif font, minimum 10pt equivalent
   - No Client IDs, Subscription IDs, tenant IDs, or test URLs anywhere in the diagram
  QUALITY REQUIREMENTS
   - Output the diagram at HIGH RESOLUTION (minimum 4096px wide, 300 DPI equivalent). Do not downscale or compress the image.
   - All text must remain SHARP and CRISP. No blurring, anti-aliasing artifacts, or fuzzy edges on any text labels, arrow labels, badges, or box content.
   - Arrow labels must be rendered at the same text quality as box content -- fully legible at both 100% and 50% zoom.
   - Preserve all fine details: protocol badge text (ACTIVE, IMPLEMENTED, AVAILABLE), OBO step numbers (1-4), Foundry IQ pipeline arrows, deduplication box
  labels, infrastructure layer icons and service names.
   - The final output should be print-ready for an A3 or conference poster format without any loss of text readability.
